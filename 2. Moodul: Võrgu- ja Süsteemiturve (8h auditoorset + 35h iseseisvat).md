
Siin on teie t√§ielik, s√ºvendatud tunnimaterjal mooduli **"V√µrgu- ja S√ºsteemiturve" (8 tundi auditoorset)** kohta.

-----

# 2\. Moodul: V√µrgu- ja S√ºsteemiturve (8h auditoorset + 35h iseseisvat)

-----

## 2.1. V√µrguturbe alused (2 tundi)

V√µrguturvalisus algab **v√µrgupiirilt** ja laieneb sisev√µrgu igasse ossa. Selle keskne strateegia on **s√ºgavuti kaitsmine (*Defense in Depth*)**, mis kasutab r√ºndaja aeglustamiseks erinevaid kaitsekihte.

### A. Tulem√º√ºrid (*Firewalls*) ja nende toimimine

Tulem√º√ºrid on turvareeglite j√µustajad. Nende √ºlesanne on **eraldada usaldusv√§√§rsed v√µrgud ebausaldusv√§√§rsetest** ja luua organisatsioonis turvatsoone (nt **DMZ** veebiserverite jaoks).

  * **P√µhim√µte:** "Eita k√µike, luba ainult vajalik." Iga tulem√º√ºr peab l√µppema **vaikimisi eitamise (*Implicit Deny*)** reegliga.
  * **Olekuga Tulem√º√ºrid (*Stateful*):** Need on standardsed t√§nap√§eval. Need ei kontrolli mitte ainult paketi p√§iseid, vaid ka **seansi olekut**. N√§iteks, kui sisev√µrgust algatati v√§ljuv p√§ring pordil 80, lubab *stateful* tulem√º√ºr vastuse automaatselt tagasi, ilma et peaks looma uut lubavat reeglit siseneva liikluse jaoks.
  * **Veebirakenduse Tulem√º√ºr (WAF):** Erinevalt v√µrgu tulem√º√ºrist t√∂√∂tab WAF **rakenduskihi (OSI 7. kiht)** tasemel. See suudab anal√º√ºsida HTTP/HTTPS-p√§ringute **sisu** ja blokeerida spetsiifilised koodip√µhised r√ºnded, nagu andmebaasi p√§ringu s√ºstimine (*SQL Injection*) ja HTML-i koodi lisamine (*XSS*).

### B. IDS/IPS-s√ºsteemid ‚Äì Tuvastamine ja Ennetamine

Need s√ºsteemid t√§iendavad tulem√º√ºri, keskendudes **r√ºndetegevuse mustritele** ja **anomaaliatele** v√µrgu sees.

  * **Sissetungituvastuss√ºsteem (IDS):** J√§lgib liiklust ja logisid. Kasutab tavaliselt kas:
    1.  **Allkirjap√µhist meetodit:** Tuvastab teadaolevate r√ºndete mustrid (*signatures*), nagu lunavara C2-serveriga suhtlemine.
    2.  **Anomaaliap√µhist meetodit:** Tuvastab ebahariliku k√§itumise, n√§iteks sisev√µrgus oleva masina ootamatu katse skaneerida teisi v√µrguporte.
  * **Sissetungit√µkestuss√ºsteem (IPS):** Asetatakse liinile (*in-line*) ja on **aktiivne**. Kui IPS tuvastab ohu, katkestab see **automaatselt** seansi ja lisab r√ºndaja IP-aadressi musta nimekirja.

### C. V√µrgu Segmenteerimine ja K√ºlgedele Liikumise T√µkestamine

V√µrgu jagamine **isoleeritud turvatsoonideks** (VLAN-id ja vastavad tulem√º√ºrid) on h√§davajalik. **Tundlikud andmed ja kriitilised s√ºsteemid** peavad asuma k√µige rangema kontrolli all olevates tsoonides.

  * **K√ºlgedele Liikumine (*Lateral Movement*):** See on r√ºndaja tegevus peale esmast sisenemist. Kui r√ºndaja kompromiteerib √ºhe n√µrga t√∂√∂koha, kasutab ta seda sillana, et liikuda edasi v√§√§rtuslikumate sihtm√§rkideni (nt andmebaasiserverid). √ïige segmenteerimine teeb selle liikumise raskemaks.

-----

### **Elulised n√§ited: V√µrguturbe alused**

| Valdkond | Eluline N√§ide | Juhtum ja Allikas |
| :--- | :--- | :--- |
| **IDS/IPS-i puudumine** | üí∞ **Krediitkaardiandmete vargus:** Jaem√º√ºja v√µrgust varastati 40 miljoni kliendi kaardiandmed. R√ºndaja oli v√µrgus **kuude v√§ltel** pahavara paigaldamas. | **Juhtum: Target Corporation, 2013**<br>Targeti **IDS tuvastas** andmete eksfiltratsiooni (suure hulga tundmatute andmete liikumise), kuid **hoiatus ignoreeriti** v√µi ei olnud piisavalt prioriseeritud, lastes r√ºnnakul s√ºveneda. *(Allikas: Kongressi raport 2014, Kroll uurimine)* |
| **V√µrgu ebapiisav segmenteerimine** | üåê **Lunavara kiire levik sisev√µrgus:** √úhte t√∂√∂jaama nakatanud lunavara levis kiiresti √ºle kogu globaalse v√µrgu, sest **puudusid piiravad tulem√º√ºrid** eri osakondade vahel. | **Juhtum: Maersk, 2017 (NotPetya)**<br>Lunavara levis √ºlemaailmses v√µrgus, kuna ettev√µtte t√ºtarettev√µtete vahel oli **liiga v√§he segmentimist**. √úhest nakatunud masinast sai alguse ahelreaktsioon, mis halvendas globaalse logistika. *(Allikas: Wired: The Untold Story of NotPetya)* |

-----

## 2.2. Ligip√§√§su kontroll ja autentimine (2 tundi)

Ligip√§√§su kontrolli eesm√§rk on rakendada **V√§hima √ïiguse P√µhim√µtet (*Principle of Least Privilege* - PoLP)**, mis on turvalisuse nurgakivi.

### A. AAA Kontseptsioon ‚Äì Turvalisuse kolm sammast

See on turvalisuse raamistik, mis haldab kasutaja interaktsiooni IT-ressurssidega.

  * **Autentimine (*Authentication*):** **T√µestab** kasutaja identiteeti. See hindab t√µendusmaterjali (**teave**, **omand** v√µi **omadused**).
  * **Autoriseerimine (*Authorization*):** **M√§√§rab √µigused**. See on s√ºsteemi seadistus, mis otsustab, millistele ressurssidele (failid, kaustad, andmebaasi read) on autentitud kasutajal juurdep√§√§s ja millisel tasemel (lugemine/kirjutamine/kustutamine). Eba√µnnestunud autoriseerimine on levinud viga veebirakendustes.
  * **Aruandlus (*Accounting*):** **J√§lgib tegevust**. See logib k√µik kasutaja tegevused (nt sisselogimise kellaaeg, eba√µnnestunud katsed, ressursi juurdep√§√§s). See on kriitilise t√§htsusega hilisemaks **turvaintsidentide anal√º√ºsiks** ja **kohtuekspertiisiks**.

### B. Mitmefaktoriline Autentimine (MFA/2FA)

MFA on parim kaitse paroolivarguse ja **r√ºndajate paroolip√µhiste brute-force r√ºnnakute** vastu.

  * **Reaalsed Faktorid:** Tugev MFA peab kombineerima **kahte v√µi enamat tegurit erinevast kategooriast**. N√µrgim on SMS-p√µhine (vastuv√µtlik *SIM-Swapping* r√ºnnetele). Parim on **FIDO2 standardil** p√µhinev f√º√ºsiline turvav√µti, mis on vastupidav ka *phishing'ule*.
  * **V√§him √ïigus:** Ka IAM-is peaks olema MFA n√µutav ka k√µige madalama privileegiga kontode jaoks.

### C. Identiteedi- ja Ligip√§√§suhaldus (IAM)

IAM on terviklik s√ºsteem (nt **Active Directory, Azure AD, Okta**), mis haldab tsentraliseeritult ja **√ºhtlaselt** k√µiki organisatsiooni kasutajate identiteete ja juurdep√§√§su.

  * **√úhekordne sisselogimine (*Single Sign-On - SSO*):** IAM-i funktsioon, mis v√µimaldab kasutajal logida sisse √ºks kord ja saada juurdep√§√§s mitmele rakendusele ilma parooli uuesti sisestamata. Kuigi see on mugav, peab **SSO-kontol olema alati MFA**.

Kindlasti\! Identiteedi- ja ligip√§√§suhaldus (**IAM**) on t√§nap√§eva k√ºberturvalisuse A ja O, eriti pilvekeskkonnas. Koostan teile sisuka teksti, mis aitab IAM-i kontseptsiooni paremini m√µista, ning lisan kohe juurde ka √ºhe olulise elulise n√§ite.

-----

# Identiteedi- ja Ligip√§√§suhaldus (IAM) S√ºgavamalt

Identiteedi- ja ligip√§√§suhaldus (**IAM**) on tsentraliseeritud raamistik ja s√ºsteemid, mis tagavad, et k√µik digitaalsed subjektid (inimesed, s√ºsteemid, teenused) saavad √µiged √µigused √µigel ajal. Lihtsamalt √∂eldes: IAM on organisatsiooni **digitaalne uksehoidja ja turva√ºlem** samaaegselt.

## Miks on IAM Kriitiline?

Enne IAM-i haldas iga rakendus ja s√ºsteem oma kasutajaid eraldi. Kui t√∂√∂taja liitus organisatsiooniga, pidi IT-osakond looma talle konto k√ºmnes eri s√ºsteemis; kui ta lahkus, tuli need k√ºmnes s√ºsteemis sulgeda. See oli ebaefektiivne ja ohtlik.

IAM lahendab selle, luues **√ºhe keskse usaldusv√§√§rse identiteedi** (nn *Source of Truth*) iga t√∂√∂taja jaoks.

### 1\. Tsentraliseeritud Haldus

IAM-s√ºsteem (nt **Microsoft Entra ID/Azure AD**, **Active Directory**, **Okta**) haldab **Autentimist** ja **Autoriseerimist** √ºhest kohast.

  * **√úhekordne Sisselogimine (*Single Sign-On ‚Äì SSO*):** See on IAM-i p√µhifunktsioon. Kasutaja logib sisse √ºhele s√ºsteemile (nt ettev√µtte sisev√µrgu portaal) ja saab automaatselt juurdep√§√§su k√µigile teistele lubatud teenustele (nt Office 365, Slack, Salesforce). See parandab **kasutajakogemust** ja **turvalisust**, sest kasutaja peab meeles pidama ainult √ºht, tugevat parooli (millel on loodetavasti **MFA**).
  * **Eluts√ºkli Haldus:** Kui t√∂√∂taja liitub v√µi lahkub, haldab IAM tema ligip√§√§su automaatselt, tagades, et **lahkuva t√∂√∂taja √µigused t√ºhistatakse koheselt** igas s√ºsteemis.

### 2\. PoLP J√µustamine ja K√ºlgedele Liikumise T√µkestamine

IAM-i peamine turva√ºlesanne on **V√§hima √ïiguse P√µhim√µtte (PoLP)** rangelt j√µustamine.

  * **Liigsete √µiguste oht:** Kui arendaja teenusekontol on **administraatori √µigused** pilvekeskkonnas, kuigi ta vajab vaid lugemis√µigust (rikub PoLP-d), on tegemist IAM-i veaga. Kui r√ºndaja selle konto kompromiteerib, saab ta konto *√ºleliigsete* √µiguste t√µttu koheselt tekitada maksimaalset kahju (nt kustutada terve andmebaasi).
  * **Pilvespetsiifiline:** Pilvekeskkondades (AWS, Azure) antakse ligip√§√§s ressursile spetsiifiliste IAM-i **poliitikate** (reeglite) abil. Neid reegleid on sageli keeruline seadistada ja **valesti konfigureerimine** ongi peamine turvaauk.

### 3\. J√§rgmine Tase: *Just-in-Time* (JIT) Ligip√§√§s

Arenenud IAM-s√ºsteemid rakendavad p√µhim√µtet, et **p√ºsivaid administratiivseid √µigusi ei ole**.

  * **JIT-ligip√§√§s:** Kasutaja saab administratiivsed √µigused **ainult siis, kui ta neid parasjagu vajab**, ja need t√ºhistatakse automaatselt n√§iteks 30 minuti p√§rast. See v√§hendab oluliselt r√ºnnatavat aega, sest suurema osa ajast on kontod madalama privileegiga.

-----

## Eluline N√§ide: IAM-i Konfiguratsiooniviga Pilves

| Valdkond | Eluline N√§ide | Juhtum ja Allikas |
| :--- | :--- | :--- |
| **IAM-i √ºlekasutamine / PoLP rikkumine** | üîí **IAM-i rolli liiga suured √µigused:** Kr√ºptoraha b√∂rsi arendusmeeskond andis oma teenusekontole AWS-is ligip√§√§su **kogu** S3 andmesalvele (*bucket*), kuigi nad vajasid ligip√§√§su vaid √ºhele kaustale. R√ºndaja kompromiteeris konto ja suutis varastada tundlikud andmed. | **Juhtum: Code Spaces, 2014**<br>Pilve- ja arendusteenuste pakkuja Code Spaces pidi p√§rast **AWS-i juurkasutaja konto kompromiteerimist** tegevuse l√µpetama. R√ºndaja sai juurdep√§√§su nende **AWS IAM-i s√ºsteemile** ja kasutas **√ºleliigseid √µigusi** (*Over-privileged Access*), et kustutada ettev√µtte k√µik varundused ja tootmisserverid, sundides ettev√µtet pankrotistuma. *(Allikas: Code Spaces'i avaldus (vt n√§iteks The Register'i artiklit), AWS-i turvaanal√º√ºsid)* |

See n√§ide r√µhutab, et IAM-i turvalisus ei ole ainult sisenemise kontroll ‚Äì see on kontroll selle √ºle, millist **kahju** kompromiteeritud identiteet suudab tekitada. PoLP rikkumine viis ettev√µtte tegevuse l√µpetamiseni.

-----

### **Elulised n√§ited: Ligip√§√§su kontroll ja autentimine**

| Valdkond | Eluline N√§ide | Juhtum ja Allikas |
| :--- | :--- | :--- |
| **MFA puudumine** | üíª **K√µrgetasemelise konto √ºlev√µtmine:** R√ºndajad said k√§tte Twitteri t√∂√∂taja sisselogimisandmed sotsiaalse inseneeria abil. Kuna kontol **polnud MFA seadistatud**, said nad kontrolli alla sisemised t√∂√∂riistad. | **Juhtum: Twitter/X, 2020**<br>R√ºnne oli v√µimalik, kuna t√∂√∂taja kontol **polnud MFA seadistatud** ja r√ºndajad said seet√µttu kasutada varastatud kontot Bitcoini petuskeemi l√§biviimiseks. *(Allikas: The Verge (2020), USA Justiitsministeerium)* |
| **Autoriseerimise (PoLP) viga** | üõí **Kliendiandmete lohakas avaldamine:** Veebilehe tarkvara viga v√µimaldas tavakasutajal muuta URL-is kliendi ID-d ja vaadata teiste klientide andmeid, kuna s√ºsteem ei kontrollinud piisavalt kasutaja √µigusi. | **Juhtum: British Airways, 2018 (Andmeleke)**<br>Kuigi BA intsident oli keerulisem, on **katkised autoriseerimise vead (OWASP A01)** veebirakendustes √§√§rmiselt levinud. Puudulik autoriseerimine t√§hendab, et s√ºsteem rikub **PoLP-d**, andes kasutajale rohkem √µigusi kui vaja. *(Allikas: ICO trahv ja raport 2020)* |

-----

## 2.3. Operatsioonis√ºsteemide turvalisus (2 tundi)

Operatsioonis√ºsteemi (OS) turvalisus keskendub sellele, kuidas **konfigureerida** ja **hallata** servereid, t√∂√∂jaamu ja l√µpp-punkte (*endpoints*) vastupidavaks r√ºnnakutele.

### A. S√ºsteemi K√µvastamine (*Hardening*) ja R√ºnnatav Pind

K√µvastamine on protsess, mille k√§igus **k√µik mittevajalik** eemaldatakse ja **turvalisus maksimeeritakse** tootja vaikeseadete asemel.

  * **R√ºnnatav Pind (*Attack Surface*):** Iga s√ºsteemi osa, mida r√ºndaja saab kasutada. Eesm√§rk on seda pinda **v√§hendada**.
  * **P√µhimeetmed:** Eemaldada k√µik ebavajalikud teenused (nt Telnet, vana SMBv1), keelata *Guest* kontod, rakendada **PoLP** s√ºsteemiprotsesside ja kasutajate jaoks ning seadistada tulem√º√ºr ka operatsioonis√ºsteemi sees (nt Windows Firewall).

### B. Plaastrite Haldus (*Patch Management*) ja haavatavused

See on pidev protsess, mis n√µuab s√ºstemaatilisust. Ebaefektiivne plaastrite haldus on k√µige levinum **turvan√µrkuse allikas**.

  * **Eluts√ºkkel:** Turvapaiga avaldamine -\> **Riski hindamine** (kriitilisus) -\> **Testimine** (nt *Staging* keskkonnas, et v√§ltida tootmise rikkeid) -\> **Juurutamine** tootmiss√ºsteemidesse.
  * **Haavatavuse Skanneerimine:** Kasutatakse regulaarselt tarkvara (nt Nessus, OpenVAS), et tuvastada s√ºsteemidest **paikamata haavatavused** ja kiirendada plaastrite haldust.

### C. Vaikimisi Seaded ja Konfiguratsioonistandardid

Turvalisus peab olema **konkreetne ja m√µ√µdetav**.

  * **Vaikimisi Seaded:** R√ºndajad kasutavad automatiseeritud t√∂√∂riistu, mis otsivad internetist just **vaikimisi paroolidele** j√§etud seadmeid (eriti IoT ja v√µrguseadmeid).
  * **CIS Benchmarks:** **Center for Internet Security** poolt v√§lja antud detailsed juhised, mis pakuvad **t√∂√∂stusharu standardiks** muutunud kontrollnimekirju serverite, t√∂√∂jaamade ja v√µrguseadmete turvaliseks konfigureerimiseks.

-----

### **Elulised n√§ited: Operatsioonis√ºsteemide turvalisus**

| Valdkond | Eluline N√§ide | Juhtum ja Allikas |
| :--- | :--- | :--- |
| **Plaastrite halduse puudumine** | üíª **Lunavara √ºlemaailmne levik:** R√ºndajad kasutasid √ºhte turvaauku (*EternalBlue*), mis oli tuntud, kuid paljudes s√ºsteemides paikamata. Lunavara levis kulutulena √ºle v√µrkude. | **Juhtum: WannaCry, 2017**<br>Lunavara kasutas Microsofti **teadaolevat** haavatavust (MS17-010), mille jaoks oli turvapaik v√§lja antud 2 kuud varem. Organisatsioonid, kes olid plaastrid paigaldamata j√§tnud, said r√ºnnakus kannatada. *(Allikas: Microsofti turvateade MS17-010, turvafirmade anal√º√ºsid)* |
| **K√µvastamise puudumine / Vaikeseaded** | üí° **Koduseadmete Botnet:** Tuhanded kaamerad ja ruuterid kaaperdati nende **vaikimisi paroolide** (*admin/admin*) t√µttu, moodustades hiiglasliku *Botneti* DDoS-r√ºnnakute jaoks. | **Juhtum: Mirai Botnet, 2016**<br>See *malware* skaneeris internetti IoT-seadmete (kaamerad, DVR-id) otsingul, millel olid **vaikimisi seadistused**. *Botnet* teostas seej√§rel **√ºhe suurima DDoS-r√ºnnaku** ajaloos. *(Allikas: Brian Krebs (KrebsOnSecurity) anal√º√ºs Mirai kohta)* |

-----

## 2.4. Pilveturvalisus (2 tundi)

Pilves (nt AWS, Azure, Google Cloud) kasutatavate teenuste turvalisus on **jagatud** pilveteenuse pakkuja (CSP) ja kliendi vahel. **See on mooduli k√µige olulisem ja spetsiifilisem teema.**

### A. Jagatud Vastutuse Mudel (*Shared Responsibility Model*)

Turvalisuse piirid on jagatud:

  * **CSP Vastutus (Turvalisus PILVEST EESTI):** CSP vastutab **globaalse taristu** (andmekeskuse turvalisus, riistvara, vool, virtualiseerimiskiht, *Network Fabrics*) turvalisuse eest.
  * **Kliendi Vastutus (Turvalisus PILVES):** Klient vastutab **k√µige** eest, mida ta pilve paigutab ja konfigureerib (andmed, andmete kr√ºpteerimine, virtuaalsed tulem√º√ºrid, *Guest* OS-i paigaldus ja paigad, IAM-i reeglid). **Kliendi viga konfiguratsioonis on peamine rikkumiste p√µhjus pilves.**

### B. Peamised Pilvep√µhised Konfiguratsioonivead

Pilvekeskkonnas viivad rikkumisteni peaaegu alati **inimese tehtud vead konfiguratsioonis**, mitte CSP-taristu rikked.

1.  **IAM-i √ºlekasutamine/valesti seadistamine:** Teenusekontodele antakse **administraatori√µigused** (*Over-privileged Service Accounts*), kuigi nad vajavad vaid lugemis√µigust.
2.  **Avalikult Avatud Hoiukohad:** S3 *bucket'id*, Azure Storage Account'id v√µi teised andmehoiukohad j√§etakse kogemata **avalikuks ja autentimata** ligip√§√§setavaks.
3.  **Kr√ºpteerimise puudumine:** Kliendid j√§tavad andmed kr√ºpteerimata (nii puhkeolekus *at rest* kui ka transpordil), arvates, et pilvepakkuja teeb seda automaatselt.

-----

### **Elulised n√§ited: Pilveturvalisus**

| Valdkond | Eluline N√§ide | Juhtum ja Allikas |
| :--- | :--- | :--- |
| **Kliendi viga (IAM / S3 seaded)** | üîí **S3 *bucket'i* avalikuks j√§tmine:** Kliendi arendaja seadistas Amazon S3 andmebaasi hoiukoha valesti, j√§ttes tundlikud andmed **interneti kaudu anon√º√ºmselt ligip√§√§setavaks**. | **Juhtum: Verizon/Deep Root Analytics, 2017**<br>Avalikult seadistatud S3 *bucket* sisaldas ligi 200 miljoni USA valija andmeid. Viga oli kliendi poolses **IAM-i konfiguratsioonis** (CSP andis t√∂√∂riista, aga klient seadistas selle valesti). *(Allikas: UpGuard‚Äôi raport ja Verizon/Deep Root Analytics'i vastus)* |
| **Kliendi viga (WAF/Virtuaalv√µrk)** | üí≥ **Kliendi poolt valesti seadistatud kaitse:** R√ºndaja kasutas √§ra valesti konfigureeritud veebirakenduse tulem√º√ºri (**WAF**), et p√§√§seda ligi AWS-is asuvatele serveritele. Lekkis 100 miljoni kliendi teave. | **Juhtum: Capital One, 2019**<br>Viga peitub selles, et r√ºnnak oli v√µimalik t√§nu **kliendipoolsetele turvavigadele** pilves, kus WAF-i reeglid (mis on kliendi vastutus) ei suutnud konkreetset r√ºnnakut t√µkestada. *(Allikas: USA Justiitsministeeriumi s√º√ºdistus, Capital One avaldused)* |

-----

## Iseseisva t√∂√∂ (35 tundi) soovituslik jaotus

  * **Tulem√º√ºri/V√µrgu laborid (15h):** Seadistage virtuaalkeskkonnas tulem√º√ºr (nt Linuxi `iptables` v√µi **pfSense**) ja proovige luua reeglid, mis lubavad HTTP/HTTPS-liiklust, kuid keelavad muud pordid. Loo lihtne IDS-s√ºsteem (**Snort/Suricata**).
  * **Identiteedi laborid (10h):** Tutvuge **Active Directory** (v√µi pilve IAM) p√µhim√µtetega. Looge erinevate √µigustega kasutajaid ja testige **PoLP** rakendamist. Harjutage GnuPG abil kr√ºpteerimist/dekr√ºpteerimist.
  * **S√ºsteemi k√µvastamine (5h):** Valige kas Linux v√µi Windows Server ja rakendage sellele **CIS Benchmarks** soovituste p√µhjal *hardening*. Eemaldage mittevajalikud teenused, keelake tarbetud pordid.
  * **Pilve uurimine (5h):** Uurige AWS v√µi Azure **Shared Responsibility Model** ametlikke dokumente. Keskenduge S3 *bucket'ite* v√µi Storage Account'ide turvalisuse seadistamisele.
